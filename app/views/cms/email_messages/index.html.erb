<% @page_title = t('browsercms.administration')+" / "+t('browsercms.email.title') %>
<% @toolbar_title = t('browsercms.email.title') %>

<div class="roundedcorners">
  <table  class="data" width="100%">
    <thead>
      <tr>
        <th class="first"></th>
        <th><div class="dividers"><%= t 'browsercms.email.recipient' %></div></th>
        <th><div class="dividers"><%= t 'browsercms.email.subject' %></div></th>
        <th style="width: 20%;"><%= t 'browsercms.email.delivered' %></th>
	<th class="last"></th>
    </tr>
  </thead>
  <tbody>
    <% @messages.each do |message|%>
      <tr>
        <td class="first"></td>
        <td><div class="dividers"><%= link_to h(truncate(message.recipients)), [:cms, message] %></div></td>
        <td><div class="dividers"><%= link_to h(truncate(message.subject)), [:cms, message] %></div></td>
        <td style="white-space: nowrap"><%=h time_on_date(message.delivered_at) %></td>
	<td class="last"></td>
      </tr>
    <% end %>
    <% if @messages.empty? %>
      <tr>
	<td class="first">&nbsp;</td>
	<td colspan="3" style="height: 30px; padding-top:10px; letter-spacing: 2px;"><%= t('browsercms.email.no_messages') %></td>
	<td class="last">
      </tr>
    <% end %>
  </tbody>
</table>
<div class="tl"></div>
<div class="tr"></div>
<div class="bl"></div>
<div class="br"></div>
</div>
<% if @messages.total_pages > 1 %>
  <%= render_pagination @messages, :email_messages %>
<% end %>
